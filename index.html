<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YihaoCar | å°ˆæ¥­æ¥é€è²»ç”¨è©¦ç®—</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #0056b3;
            --primary-hover: #004494;
            --line-green: #00b900;
            --accent-orange: #ff9800;
            --bg-soft: #f4f7f9;
            --text-dark: #2c3e50;
            --glass-bg: rgba(255, 255, 255, 0.95);
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background: linear-gradient(135deg, #cfdef3 0%, #e0eafc 100%);
            background-attachment: fixed;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            color: var(--text-dark);
        }

        .main-card {
            background: var(--glass-bg);
            width: 100%;
            max-width: 480px;
            padding: 40px 30px;
            border-radius: 35px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.1);
            position: relative;
            box-sizing: border-box;
        }

        .brand-zone {
            text-align: center;
            margin-bottom: 35px;
        }

        .brand-logo {
            font-size: 38px;
            font-weight: 900;
            color: var(--primary);
            letter-spacing: -1.5px;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.05);
        }

        .brand-tagline {
            font-size: 13px;
            font-weight: 500;
            color: #8899a6;
            letter-spacing: 3px;
            margin-top: 5px;
            text-transform: uppercase;
        }

        .form-group {
            margin-bottom: 22px;
            position: relative;
        }

        .form-label {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 15px;
            font-weight: 700;
            margin-bottom: 10px;
            color: #4a5568;
        }

        .input-box {
            width: 100%;
            padding: 16px 18px;
            padding-right: 110px; /* ç•™çµ¦å®šä½æŒ‰éˆ• */
            border: 2px solid #e2e8f0;
            border-radius: 16px;
            font-size: 16px;
            background: #fff;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-sizing: border-box;
        }

        .input-box:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(0, 86, 179, 0.1);
            outline: none;
        }

        .btn-location {
            position: absolute;
            right: 10px;
            bottom: 7px;
            padding: 8px 14px;
            background: #f0f7ff;
            color: var(--primary);
            border: 1.5px solid var(--primary);
            border-radius: 12px;
            font-size: 12px;
            font-weight: 700;
            cursor: pointer;
            transition: 0.2s;
        }

        .btn-location:hover {
            background: var(--primary);
            color: white;
        }

        .options-row {
            display: flex;
            gap: 12px;
            margin-bottom: 30px;
        }

        .opt-btn {
            flex: 1;
            background: #f8fafc;
            border: 1.5px solid #e2e8f0;
            padding: 12px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 13px;
            cursor: pointer;
            transition: 0.3s;
        }

        .opt-btn input { margin-right: 8px; cursor: pointer; }

        .opt-btn:hover {
            border-color: var(--primary);
            background: #fff;
        }

        .btn-calculate {
            width: 100%;
            background: var(--primary);
            color: white;
            padding: 18px;
            font-size: 18px;
            font-weight: 700;
            border: none;
            border-radius: 18px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 10px 20px rgba(0, 86, 179, 0.2);
        }

        .btn-calculate:hover {
            background: var(--primary-hover);
            transform: translateY(-2px);
            box-shadow: 0 15px 25px rgba(0, 86, 179, 0.3);
        }

        .btn-calculate:active { transform: translateY(0); }

        .result-panel {
            margin-top: 35px;
            padding: 25px;
            background: linear-gradient(145deg, #ffffff, #f8fbff);
            border-radius: 25px;
            border: 1px solid #e1e9f5;
            display: none;
            animation: fadeIn 0.6s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-title {
            font-size: 14px;
            color: #718096;
            font-weight: 700;
            text-transform: uppercase;
        }

        .result-price {
            font-size: 40px;
            font-weight: 900;
            color: var(--primary);
            margin: 10px 0;
        }

        .result-info {
            font-size: 14px;
            line-height: 1.6;
            color: #4a5568;
            border-top: 1px dashed #cbd5e0;
            padding-top: 15px;
            margin-top: 15px;
        }

        .btn-line {
            width: 100%;
            background: var(--line-green);
            color: white;
            padding: 16px;
            font-size: 17px;
            font-weight: 700;
            border: none;
            border-radius: 16px;
            margin-top: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            cursor: pointer;
            transition: 0.3s;
        }

        .btn-line:hover { opacity: 0.9; }

        .disclaimer {
            font-size: 11px;
            color: #a0aec0;
            text-align: center;
            margin-top: 25px;
            line-height: 1.5;
        }

        /* ä¿®é£¾ä¸‹æ‹‰é¸å–® */
        .pac-container {
            border-radius: 16px;
            margin-top: 8px;
            box-shadow: 0 12px 24px rgba(0,0,0,0.1);
            border: none;
            font-family: inherit;
        }
    </style>
</head>
<body>

<div class="main-card">
    <div class="brand-zone">
        <h1 class="brand-logo">YihaoCar</h1>
        <div class="brand-tagline">Premium Service Trial</div>
    </div>

    <div class="form-group">
        <label class="form-label">ğŸ”µ èµ·é»ä½ç½®</label>
        <input type="text" id="start" class="input-box" placeholder="è¼¸å…¥åœ°å€æˆ–åœ°æ¨™">
        <button class="btn-location" onclick="getCurrentLocation()">ğŸ“ å®šä½</button>
    </div>

    <div class="form-group">
        <label class="form-label">ğŸŸ  çµ‚é»ä½ç½®</label>
        <input type="text" id="end" class="input-box" placeholder="æ‚¨æƒ³å»å“ªè£¡ï¼Ÿ">
    </div>

    <div class="options-row">
        <label class="opt-btn">
            <input type="checkbox" id="avoidHighways"> é¿é–‹é«˜é€Ÿ
        </label>
        <label class="opt-btn">
            <input type="checkbox" id="avoidTolls"> é¿é–‹æ”¶è²»
        </label>
    </div>

    <button id="calc-btn" class="btn-calculate" onclick="calculateFare()">ç«‹å³è©¦ç®—è²»ç”¨</button>

    <div id="result" class="result-panel">
        <div class="result-title">é ä¼°ç¸½è²»ç”¨</div>
        <div id="price-tag" class="result-price">$0</div>
        <div id="info-tag" class="result-info"></div>
        
        <button class="btn-line" onclick="copyAndLine()">
            <img src="https://upload.wikimedia.org/wikipedia/commons/4/41/LINE_logo.svg" width="22" alt="LINE">
            è¤‡è£½çµæœä¸¦é ç´„
        </button>
    </div>

    <div class="disclaimer">
        è¨ˆè²»æ©Ÿåˆ¶ï¼šèµ·æ­¥ $80 + é‡Œç¨‹ $15/km + æ™‚é–“ $3/min<br>
        é•·é€”è¡Œç¨‹ (>15km) æ¯å…¬é‡ŒåŠ æ”¶ $10ã€‚<br>
        â€» è©¦ç®—çµæœåƒ…ä¾›åƒè€ƒï¼Œå¯¦éš›è²»ç”¨ä¾å¸æ©Ÿå ±åƒ¹ç‚ºæº–ã€‚
    </div>
</div>

<script>
    let autocompleteStart, autocompleteEnd;

    // åˆå§‹åŒ– Google Autocomplete
    function initService() {
        const options = { componentRestrictions: { country: "tw" } };
        autocompleteStart = new google.maps.places.Autocomplete(document.getElementById('start'), options);
        autocompleteEnd = new google.maps.places.Autocomplete(document.getElementById('end'), options);
    }

    // å®šä½åŠŸèƒ½
    function getCurrentLocation() {
        const btn = document.querySelector('.btn-location');
        if (!navigator.geolocation) return alert('ç€è¦½å™¨ä¸æ”¯æ´å®šä½');
        
        btn.innerText = 'å®šä½ä¸­...';
        btn.disabled = true;

        navigator.geolocation.getCurrentPosition(
            (position) => {
                const latlng = { lat: position.coords.latitude, lng: position.coords.longitude };
                new google.maps.Geocoder().geocode({ location: latlng }, (results, status) => {
                    btn.innerText = 'ğŸ“ å®šä½';
                    btn.disabled = false;
                    if (status === "OK" && results[0]) {
                        document.getElementById('start').value = results[0].formatted_address.replace('å°ç£', '').trim();
                    }
                });
            },
            () => {
                btn.innerText = 'ğŸ“ å®šä½';
                btn.disabled = false;
                alert('å®šä½å¤±æ•—ï¼Œè«‹ç¢ºèªå·²é–‹å•Ÿ HTTPS ä¸”æˆäºˆæ¬Šé™');
            },
            { enableHighAccuracy: true, timeout: 8000 }
        );
    }

    // è»Šè³‡è¨ˆç®—
    function calculateFare() {
        const start = document.getElementById('start').value;
        const end = document.getElementById('end').value;
        const btn = document.getElementById('calc-btn');
        const hwy = document.getElementById('avoidHighways').checked;
        const toll = document.getElementById('avoidTolls').checked;

        if (!start || !end) return alert('è«‹å¡«å¯«å®Œæ•´è¡Œç¨‹åœ°é»');

        btn.disabled = true;
        btn.innerText = 'æ­£åœ¨é€£çµæ•¸æ“šæº...';

        const service = new google.maps.DistanceMatrixService();
        service.getDistanceMatrix({
            origins: [start],
            destinations: [end],
            travelMode: 'DRIVING',
            avoidHighways: hwy,
            avoidTolls: toll
        }, (response, status) => {
            btn.disabled = false;
            btn.innerText = 'ç«‹å³è©¦ç®—è²»ç”¨';

            if (status === 'OK') {
                const data = response.rows[0].elements[0];
                if (data.status !== 'OK') return alert('è·¯å¾‘è¦åŠƒå¤±æ•—ï¼Œè«‹å˜—è©¦æ›´ç²¾ç¢ºåœ°å€');

                const dist = data.distance.value / 1000;
                const time = Math.ceil(data.duration.value / 60);
                
                // YihaoCar å…¬å¼
                const base = 80;
                const distFee = dist * 15;
                const timeFee = time * 3;
                const extraFee = dist > 15 ? (dist - 15) * 10 : 0;
                const total = Math.round(base + distFee + timeFee + extraFee);

                document.getElementById('price-tag').innerText = `$${total.toLocaleString()}`;
                document.getElementById('info-tag').innerText = `é è¨ˆé‡Œç¨‹ï¼š${dist.toFixed(1)} km\né è¨ˆè»Šç¨‹ï¼š${time} åˆ†é˜\nè·¯å¾‘è¨­å®šï¼š${hwy ? 'é¿é–‹é«˜é€Ÿå…¬è·¯ ' : ''}${toll ? 'é¿é–‹æ”¶è²»ç«™' : 'ç³»çµ±æœ€é€Ÿæ¨è–¦'}`;
                
                document.getElementById('result').style.display = 'block';
                document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
            }
        });
    }

    // LINE é ç´„é‚è¼¯
    function copyAndLine() {
        const msg = `ã€YihaoCar è¡Œç¨‹é ç´„ã€‘\nèµ·é»ï¼š${document.getElementById('start').value}\nçµ‚é»ï¼š${document.getElementById('end').value}\n${document.getElementById('info-tag').innerText}\né ä¼°è²»ç”¨ï¼š${document.getElementById('price-tag').innerText}\n(â€»æ­¤ç‚ºç³»çµ±é ä¼°ï¼Œå¯¦éš›ä»¥å ±åƒ¹ç‚ºæº–)`;

        navigator.clipboard.writeText(msg).then(() => {
            alert('âœ… è¡Œç¨‹ç´°ç¯€å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼\n\nè·³è½‰åˆ° LINE å¾Œï¼Œè«‹ã€Œè²¼ä¸Šã€è¨Šæ¯å‚³é€çµ¦æˆ‘å€‘å³å¯å®Œæˆé ç´„ã€‚');
            window.location.href = "https://lin.ee/o8sVnUW";
        });
    }
</script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBtgKupEUkOqUXV5bQMx_5PlXofFu-0vO4&libraries=places&callback=initService&language=zh-TW" async defer></script>

</body>
</html>
